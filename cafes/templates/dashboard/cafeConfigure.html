<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css'>
    <title>پیکربندی کافه</title>
    <style>
        @font-face {
            font-family: Shabnam;
            src: url(/static/webfonts/Shabnam-FD.ttf);
        }
        @font-face {
            font-family: ShabnamLight;
            src: url(/static/webfonts/Shabnam-Light-FD.ttf);
        }
        @font-face {
            font-family: ShabnamMedium;
            src: url(/static/webfonts/Shabnam-Medium-FD.ttf);
        }
        @font-face {
            font-family: ShabnamBold;
            src: url(/static/webfonts/Shabnam-Bold-FD.ttf);
        }
        @font-face {
            font-family: Vazir;
            src: url(/static/webfonts/Vazir.ttf);
        }
        @font-face {
            font-family: VazirBold;
            src: url(/static/webfonts/VazirBold.ttf);
        }
        div#pageContent {
            position: absolute;
            width: 90%;
            padding: 15px;
            text-align: right;
            top: 20px;
            right: 50px;
        }
        #pTitle {
            margin: 0;
            font-family: shabnam;
            font-weight: bold;
            text-align: center;
            cursor: default;
        }
        #headPic {
            position: relative;
            width: 57%;
            height: max-content;
            border-radius: 0 20px 20px 0;
        }
        #mForm {
            position: relative;
            float: right;
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 100%;
            width: 67vmax;
            margin-top: 20px;
            padding: 5px 15px 15px 15px;
            border-radius: 10px;
        }
        .nForm {
            width: 200px;
            padding: 5px 10px 5px;
            margin-top: 8px;
            text-align: right;
            direction: rtl;
            font-family: Vazir;
            border-style: solid;
            border-width: 2px;
            border-color: thistle;
            border-radius: 10px;
            background-color: #d8bfd840;
            transition: .2s;
        }
        .nForm:focus {
            border-color: thistle;
            border-radius: 5px;
            background-color: #ece2ec40;
        }
        .fields {
            display: flex;
            flex-direction: column;
        }
        .fLabel {
            direction: rtl;
            margin-top: 18px;
            text-align: right;
            font-size: 16px;
            font-weight: 600;
            font-family: Vazir;
            cursor: default;
        }
        .fSelect {
            width: 100px;
            padding: 3px 10px;
        }
        .fText {
            width: 300px;
            font-family: Shabnam;
        }
        .backEffect {
            position: absolute;
            width: 85%;
            height: 80px;
            right: 8%;
            top: 13px;
            background: linear-gradient(to bottom right, rgb(248 244 255), #ffecca);
            border: solid 2px coral;
            border-radius: 10px;
            z-index: 1;
            opacity: 80%;
        }
        .next {
            position: absolute;
            display: none;
            right: 90%;
            top: 56px;
            background-color: #2edf4c;
            color: white;
            font-size: 18px;
            font-family: vazir;
            border-radius: 9px;
            border: solid 2px #28c442;
            padding: 7px;
            gap: 8px;
            direction: rtl;
            cursor: pointer;
            z-index: 1;
            transition: .18s;
        }
        .next:hover {
            background-color: #ffd268;
            border-color: #fcc23b;
            filter: drop-shadow(2px 2px 5px rgb(228 228 228));
        }
        #submit {
            margin-top: 30px;
            float: left;
            width: auto;
            padding: 3px 20px;
            font-weight: 600;
            color: white;
            background-color: #ff8c77;
            border-color: #d8bfd840;
            cursor: pointer;
            transition: .2s;
        }
        #submit:active {
            background-color: #ffd268;
            border-color: #fcc23b;
        }
        #submit:hover {
            background-color: #ffd268;
            border-color: #fcc23b;
        }
        #cafeBanner {
            position: absolute;
            display: none;
            width: 205px;
            height: 30px;
            left: 200px;
            top: 219px;
            font-size: 2em;
            font-family: ordibehesht;
            color: #896300;
            background-color: #e7d2a3;
            direction: rtl;
            align-items: center;
            justify-content: center;
        }
        #proEdit {
            display: flex;
            margin-top: 20px;
            border-radius: 10px;
            background-color: #d8bfd840;
            flex-direction: row;
            justify-content: center;
            align-items: center;
        }
        .picsName {
            font-family: Vazir;
            margin-bottom: 10px;
            cursor: default;
        }
        #photoEdit {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 25px;
        }
        .pPBox {
            position: relative;
        }
        .pEdit {
            position: absolute;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: space-evenly;
            width: 15px;
            height: 15px;
            color: white;
            background-color: #ff8c77;
            border-radius: 30px;
            padding: 5px;
            text-align: center;
            font-family: Vazir;
            font-size: 14px;
            bottom: 33px;
            right: 0px;
            cursor: pointer;
            transition: .2s;
        }
        .changeBtn {
            display: none;
        }
        .pEdit:hover {
            width: 100px;
            filter: drop-shadow(0px 0px 6px lightgray);
        }
        .pEdit:hover .changeBtn {
            display: block;
        }
        #pPhotoPre {
            width: 100px;
            height: 100px;
            margin-bottom: 30px;
            background-color: white;
            border-radius: 50%;
        }
        #pBackPre {
            width: 320px;
            height: 180px;
            background-color: white;
            border-radius: 5px;
        }
        #blurEffect {
            position: absolute;
            right: 0;
            top: 100px;
            width: 40%;
            height: 80%;
            backdrop-filter: blur(1px);
            filter: grayscale(1);
        }
        .popUpBg {
            position: absolute;
            display: none;
            top: 0;
            width: 100%;
            height: 100%;
            backdrop-filter: grayscale(.5) blur(1px);
            z-index: 1;
        }
        #message {
            position: absolute;
            display: none;
            left: 37.5%;
            top: 30%;
            z-index: 2;
            background-color: white;
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            filter: drop-shadow(0px 0px 8px #41414161);
            font-family: VazirBold;
            cursor: default;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .fi-rr-comment-check {
            display: none;
            padding: 20px;
            margin-bottom: 10px;
            color: white;
            font-size: 50px;
            background-color: limegreen;
            border-radius: 44%;
            filter: drop-shadow(2px 2px 0px darkgreen);
            scale: .5;
            animation: s3 .5s forwards;
        }
        .fi-rr-comment-xmark {
            display: none;
            padding: 20px;
            margin-bottom: 10px;
            color: white;
            font-size: 50px;
            background-color: red;
            border-radius: 44%;
            filter: drop-shadow(2px 2px 0px darkred);
            scale: .5;
            animation: s3 .5s forwards;
        }
        @keyframes s3 {to{scale: 1;}}
        #aClose {
            display: none;
            margin-top: 20px;
            float: unset;
            width: auto;
            padding: 2px 20px;
            font-weight: 100;
            color: white;
            background-color: grey;
            border: solid 2px white;
            font-family: Vazir;
            border-radius: 10px;
            cursor: pointer;
            transition: .1s;
        }
        #aClose:hover {
            opacity: 70%;
            border-color: #fcc23b;
        }
        .custom-loader {
            display: none;
            width:25px;
            height:25px;
            margin-top: 30px;
            border-radius:50%;
            border:4px solid;
            border-color:#FFCF9B;
            border-right-color: #C36328;
            z-index: 1;
            animation:s2 1s infinite linear;
        }
        @keyframes s2 {to{transform: rotate(1turn)}}
    </style>
</head>
<body>
    <div id="pageContent">
        <h1 id="pTitle">پیکربندی پنل کافه</h1>
        <div id="proEdit">
            <img id="headPic" src="{% static "landing/setup.jpg" %}">
            <span id="cafeBanner">کافه<span id="bannerName">میلانو</span></span>
            <form id="mForm" method="post" enctype="multipart/form-data">
                <span class="backEffect"></span>
                <div id="cafeName" class="fields" data-id="1" style="z-index: 1;">
                    <span class="nName fLabel">اسم کافه :</span>
                    {{ form.name }}
                </div>
                <div id="cafeBio" class="fields" data-id="2">
                    <span class="nName fLabel">درباره کافه :</span>
                    {{ form.bio }}
                </div>
                <div id="cafeLocation" class="fields" data-id="3">
                    <span class="nName fLabel">لوکیشن کافه (اختیاری) :</span>
                    {{ form.map_link }}
                </div>
                {{ form.pPhoto }}
                {{ form.pBackground }}
                {% csrf_token %}
                <input id="submit" class="nForm" type="submit" value="ساخت پروفایل">
                <span data-id="1" class="fi-rr-angle-circle-left next"></span>
                <span id="loading" class="custom-loader"></span>
            </form>
        </div>
        <div id="blurEffect"></div>
        <div class="popUpBg"></div>
        <div id="message">
            <span id="successIcon" class="fi-rr-comment-check" style="display: none;"></span>
            <span id="errorIcon" class="fi-rr-comment-xmark" style="display: none;"></span>
            <span id="success" class="success" style="display: none;">.پروفایل کافه شما با موفقیت ایجاد شد</span>
            <span id="error" class="success" style="display: none;">.ساخت پروفایل با خظا مواجه شد</span>
            <span id="aClose" class="delBtn">پنل کاربری</span>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2.2.1/src/js.cookie.min.js"></script>
    <script>
      $(' .nForm ').keyup(function(e) {
          event.preventDefault();
          var changed = $(this).val();

          if (changed != "") {
              $('.next').css("display", "flex");
          } else {
              $('.next').hide();
          }
      });
      $(' .next ').click(function(e) {
          var id = $(this).data('id') + 1;
          $(this).data('id', id);
          $('.next').hide();
          if (id == 3) {
            $('.backEffect').animate({ "height": "80px", "top": "345px" }, "slow" );
            $('.next').css("visibility", "hidden");
            $('#submit').css("z-index", "1");
          } else {
            $('.next').css("top", "+=244px");
            $('.backEffect').animate({ "height": "240px", "top": "100px" }, "slow" );
          }
          $('.fields').css("z-index", "0");
          $(" .fields[data-id="+ id +"] ").css("z-index", "1");
      });
      $(" #mForm ").submit(function(e) {
        e.preventDefault();
        $(" #submit ").hide();
        $(" #loading ").show();
        var serializedData = $(this).serialize();
        $.ajax({
            type: 'POST',
            url: "{% url 'cafes:cafeConfigure' %}",
            data: serializedData,
            success: function(response) {
                $(" #loading ").hide();
                $(" .popUpBg ").fadeIn(200);
                $(" #message ").css("display", "flex");
                $(" #successIcon ").css("display", "flex");
                $(" #success ").show(150);
                $(" #aClose ").show(150);
            },
            error: function(response){
                $(" #loading ").hide();
                $(" .popUpBg ").fadeIn(200);
                $(" #message ").css("display", "flex");
                $(" #errorIcon ").css("display", "flex");
                $(" #error ").show(150);
            }
        });
      });
    </script>
</body>
</html>